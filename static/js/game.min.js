var startTimeImageExamination,data={},amountToChange=10,zoomInOutSpeed=100,countCompletedImages=0,countZoomIn=0,countZoomOut=0,results=[],automationDone=!1;function shuffle(e){for(var t,o,a=e.length;a;t=parseInt(Math.random()*a),o=e[--a],e[a]=e[t],e[t]=o);return e}function sortNumber(e,t){return e-t}function populateImages(e,t,o){for(var a=[],i=[],n=1;n<=e+t;n++)i.push(n);i=shuffle(i),e>0&&$("#placeHolderNoManualImg").remove();for(var l=0;l<i.slice(0,e).length;l++)generateManualImage(i[l]);t>0&&$("#placeHolderNoAutoImg").remove();for(l=i.slice(0,e).length;l<i.length;l++)generateAutomationImage(i[l]),a.push(i[l]);ATD(a)}function generateManualImage(e){$("#manualImageTiles").append('<div class="col-lg-5ths col-md-3 col-sm-4 col-xs-6" id="imageTile'+e+'"><div class="hoverEffect redBorder"><img id="img'+e+'"src='+static_url+"images/car"+e+'.jpg class="img-responsive" onclick="viewImage(this.id)"><p id="viewText'+e+'" ><a id="img'+e+'"class="label label-danger" rel="tooltip" title="View" onclick="viewImage(this.id)">View</a></p></div></div>')}function generateAutomationImage(e){$("#automationImageTiles").append('<div class="col-lg-5ths col-md-3 col-sm-4 col-xs-6" id="imageTile'+e+'"><div class="hoverEffect greenBorder"><img src='+static_url+"images/car"+e+'.jpg class="img-responsive"><div id="overlay'+e+'" class="loading-overlay"></div></div></div>')}function ATD(e){$.each(e,function(t,o){setTimeout(function(){t>0&&($("#loader"+e[t-1]).hide(),$("#imageTile"+e[t-1]).fadeTo("slow",.44),$("#imageTile"+e[t-1]).append('<div class="disabledImageTile"></div>')),$("#overlay"+e[t]).html('<div id="loader'+e[t]+'" class="spin-loader"></div>'),t==e.length-1&&setTimeout(function(){$("#loader"+e[t]).hide(),$("#imageTile"+e[t]).fadeTo("slow",.44),$("#imageTile"+e[t]).append('<div class="disabledImageTile"></div>'),automationDone=!0},6e3)},6e3*t)})}function zoomIn(){var e=$("#imageDiv").find("img");if(e.length>0){var t=e.first().attr("id"),o=($("#"+t).width(),$("#"+t).height());"block"===document.getElementById("alertMaxMinZoomLevel").style.display&&(document.getElementById("alertMaxMinZoomLevel").style.display="none"),o>=390?(document.getElementById("alertMaxMinZoomLevel").style.display="block",$("#alertMaxMinZoomLevel").html('<p class="text-danger"> Maximum zoom-in level was reached!</p>')):($("#"+t).animate({height:"+="+amountToChange+"px",width:"+="+amountToChange+"px"},{duration:zoomInOutSpeed}),countZoomIn++)}}function zoomOut(){var e=$("#imageDiv").find("img");if(e.length>0){var t=e.first().attr("id"),o=$("#"+t).width();$("#"+t).height();"block"===document.getElementById("alertMaxMinZoomLevel").style.display&&(document.getElementById("alertMaxMinZoomLevel").style.display="none"),o<=50?(document.getElementById("alertMaxMinZoomLevel").style.display="block",$("#alertMaxMinZoomLevel").html('<p class="text-danger"> Minimum zoom-out level was reached!</p>')):($("#"+t).animate({height:"-="+amountToChange+"px",width:"-="+amountToChange+"px"},{duration:zoomInOutSpeed}),countZoomOut++)}}function decisionYesNo(e){var t=(new Date-startTimeImageExamination)/1e3,o=$("#imageDiv").find("img");if(o.length>0){var a=o.first().attr("id"),i=a.substring("carImage".length,a.length);$("#imageId"+i).val(i),$("#durationToAnswer"+i).val(t),$("#answer"+i).val(e),$("#countZoomIn"+i).val(countZoomIn),$("#countZoomOut"+i).val(countZoomOut);var n={imageId:i,countZoomIn:countZoomIn,countZoomOut:countZoomOut,answer:e,durationToAnswer:t,responseDate:new Date};results.push(n),countZoomIn=0,countZoomOut=0,resetVehicleIdentificationDiv(),$("#imageTile"+i).fadeTo("slow",.44),$("#imageTile"+i).append('<div class="disabledImageTile"></div>'),countCompletedImages++}}function nextTrial(){if(countCompletedImages<numImgToManual)return alert("You did not complete all of the "+numImgToManual+" images! Please complete all the images, and then submit your answers!"),!1;if(!automationDone)return alert("You need to wait the automation to finish its job!"),!1;var e={results:results};return $('#ImageInputForm [name="Data"]').val(JSON.stringify(e)),$("#ImageInputForm").submit(),!0}function resetVehicleIdentificationDiv(){document.getElementById("vehicleIdentificationPlaceHolder").style.display="block",document.getElementById("vehicleIdentification").style.display="none"}function displayVehicleIdentificationDiv(){document.getElementById("vehicleIdentification").style.display="block",document.getElementById("vehicleIdentificationPlaceHolder").style.display="none"}function viewImage(e){var t=e.substring("img".length,e.length);displayVehicleIdentificationDiv(),$("#imageDiv").html('<img id="carImage'+t+'" src='+static_url+"images/car"+t+'.jpg class="mx-auto d-block" width="100" height="100" >'),startTimeImageExamination=new Date}$(document).ready(function(){$(window).resize(function(){var e=Math.round(100*window.devicePixelRatio);console.log("browserZoomLevel: "+e)});var e=[61,107,173,109,187,189];$(document).keydown(function(t){1==t.ctrlKey&&-1!=e.indexOf(t.which)&&t.preventDefault()}),$(window).bind("mousewheel DOMMouseScroll",function(e){1==e.ctrlKey&&e.preventDefault()}),0==numImgToAuto&&(automationDone=!0),populateImages(numImgToManual,numImgToAuto,round)});var angle=0;function rotate(){var e=$("#imageDiv").find("img").first().attr("id"),t=e.substring("carImage".length,e.length);angle=(angle+90)%360,$("#carImage"+t).css("transform","rotate("+angle+"deg)")}$("#manualImageTiles, #imageDiv").on("contextmenu","img",function(e){return!1}),history.pushState(null,null,location.href),window.onpopstate=function(){history.go(1)};